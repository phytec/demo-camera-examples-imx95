CAM_PHYCAM_NAME="VM-017 / VM-117"

camera_select_format_interactive() {

	echo " Select Camera Sensor Format for VM-017 / VM-117"
	echo " ==============================================="

	if [ "$CAM_COLOR" = "COL" ] ; then
		echo " 1 = SGRBG8_1X8"
		echo " 2 = SGRBG10_1X10"
		echo " 3 = SGRBG12_1X12"

		read FMT_INDEX
		echo ""

		if [ -z "$FMT_INDEX" ] ; then
			CAM_FMT="SGRBG8_1X8"
		else
			case $FMT_INDEX in
				"1") CAM_FMT="SGRBG8_1X8" ;;
				"2") CAM_FMT="SGRBG10_1X10" ;;
				"3") CAM_FMT="SGRBG12_1X12" ;;
				*) echo "Invalid format selection" ; exit 1 ;;
			esac
		fi
	else
		echo " 1 = Y8_1X8"
		echo " 2 = Y10_1X10"
		echo " 3 = Y12_1X12"

		read FMT_INDEX
		echo ""

		if [ -z "$FMT_INDEX" ] ; then
			CAM_FMT="Y8_1X8"
		else
			case $FMT_INDEX in
				"1") CAM_FMT="Y8_1X8" ;;
				"2") CAM_FMT="Y10_1X10" ;;
				"3") CAM_FMT="Y12_1X12" ;;
				*) echo "Invalid format selection" ; exit 1 ;;
			esac
		fi
	fi

	format_configure $CAM_FMT
}

camera_select_format() {

	if [ -z "$1" ] ; then
		if [ "$CAM_COLOR" = "COL" ] ; then
			CAM_FMT="SGRBG8_1X8"
		else
			CAM_FMT="Y8_1X8"
		fi
	else
		CAM_FMT=$1
	fi

	format_configure $CAM_FMT

}

format_configure() {

	if [ -z "$1" ] ; then
		echo "No Format selected to configure"
		exit 1
	fi

	case $1 in
		"SGRBG8_1X8")
			CAP_FMT="GRBG"
			YAVTA_FMT="SGRBG8"
			GST_FMT="video/x-bayer,format=grbg"
			GST_CONV="bayer2rgbneon"
			;;
		"SGRBG10_1X10")
			CAP_FMT="BA10"
			YAVTA_FMT="SGRBG10"
			GST_FMT=""
			GST_CONV="bayer2rgbneon"
			;;
		"SGRBG12_1X12")
			CAP_FMT="BA12"
			YAVTA_FMT="SGRBG12"
			GST_FMT=""
			GST_CONV="bayer2rgbneon"
			;;
		"Y8_1X8")
			CAP_FMT="GREY"
			YAVTA_FMT="Y8"
			GST_FMT="video/x-raw,format=GRAY8"
			GST_CONV="queue ! videoconvert n-threads=4"
			;;
		"Y10_1X10")
			CAP_FMT="Y10"
			YAVTA_FMT="Y10"
			GST_FMT=""
			GST_CONV="queue ! videoconvert n-threads=4"
			;;
		"Y12_1X12")
			CAP_FMT="Y12"
			YAVTA_FMT="Y12"
			GST_FMT=""
			GST_CONV="queue ! videoconvert n-threads=4"
			;;
		*) echo "Unsupported Sensor Format: $1" ; exit 1
	esac

	CTRLS=""
	CTRLS="${CTRLS},exposure=2240"

	if [ "$CAM_COLOR" = "COL" ] ; then
		CTRLS="${CTRLS},digital_gain_red=1400"
		CTRLS="${CTRLS},digital_gain_blue=1400"
		CTRLS="${CTRLS},digital_gain_green_red=1000"
		CTRLS="${CTRLS},digital_gain_green_blue=1000"
	fi

	# Remove leading comma, if one exists.
	CAM_FMT_CTRLS="${CTRLS##,}"

}

camera_select_mode_interactive() {

	echo ""
	echo "Select Camera Mode for VM-017 / VM-117"
	echo "======================================"
	echo "  1 = 2592 x 1944 Full"
	echo "  2 = 2048 x 1536 QXGA, with ROI"
	echo "  3 = 1600 x 1200 UXGA, with ROI"
	echo "  4 = 1280 x 1024 SXGA, with ROI"
	echo "  5 = 1024 x 768  XGA, with Skip2, ROI and Column Binning"
	echo "  6 = 800  x 600  SVGA, with Skip2, ROI and Column Binning"
	echo "  7 = 640  x 480  VGA, with Skip4 and Column Binning"
	echo "  8 = 1920 x 1080 FullHD, with ROI"
	echo "  9 = 1280 x 720  HD, with Skip2, ROI and Column Binning"
	echo " 10 = 640  x 400  with Skip4, ROI"

	read MODE
	echo ""

	if [ -z "$MODE" ] ; then
		MODE="1"
	fi

	mode_configure $MODE

}

camera_select_mode() {

	case "$1" in
	"Full" | "Default")
		MODE="1"
		;;
	"FullHD" )
		MODE="8"
		;;
	"HD" )
		MODE="9"
		;;
	"Dual" )
		MODE="10"
		;;
	* )
		MODE="$1"
		;;
	esac

	mode_configure $MODE
}

mode_configure() {

	if [ -z "$1" ] ; then
		echo "No Mode selected to configure"
		exit 1
	fi

	CAP_FRAME_CNT="1"
	GST_SRC_OPTS=""

	CTRLS=""
	case $1 in
	"1" | "")
		CAM_MODENAME="2592x1944 Full"
		CAM_WIDTH="2592"
		CAM_HEIGHT="1944"
		CAM_OFFSET_TOP="4"
		CAM_OFFSET_LEFT="4"
		CAP_WIDTH="2592"
		CAP_HEIGHT="1944"
		CTRLS="${CTRLS},column_binning=0"
		;;
	"2")
		CAM_MODENAME="2048x1536 QXGA"
		CAM_WIDTH="2048"
		CAM_HEIGHT="1536"
		CAM_OFFSET_TOP="204"
		CAM_OFFSET_LEFT="272"
		CAP_WIDTH="2048"
		CAP_HEIGHT="1536"
		CTRLS="${CTRLS},column_binning=0"
		;;
	"3")
		CAM_MODENAME="1600x1200 UXGA"
		CAM_WIDTH="1600"
		CAM_HEIGHT="1200"
		CAM_OFFSET_TOP="372"
		CAM_OFFSET_LEFT="496"
		CAP_WIDTH="1600"
		CAP_HEIGHT="1200"
		CTRLS="${CTRLS},column_binning=0"
		;;
	"4")
		CAM_MODENAME="1280x1024 SXGA"
		CAM_WIDTH="1280"
		CAM_HEIGHT="1024"
		CAM_OFFSET_TOP="460"
		CAM_OFFSET_LEFT="656"
		CAP_WIDTH="1280"
		CAP_HEIGHT="1024"
		CTRLS="${CTRLS},column_binning=0"
		;;
	"5")
		CAM_MODENAME="1024x768 XGA with Skipping x2 and Binning"
		CAM_WIDTH="2048"
		CAM_HEIGHT="1536"
		CAM_OFFSET_TOP="204"
		CAM_OFFSET_LEFT="272"
		CAP_WIDTH="1024"
		CAP_HEIGHT="768"
		CTRLS="${CTRLS},column_binning=1"
		;;
	"6")
		CAM_MODENAME="800x600 SVGA with Skipping x2 and Binning"
		CAM_WIDTH="1600"
		CAM_HEIGHT="1200"
		CAM_OFFSET_TOP="372"
		CAM_OFFSET_LEFT="496"
		CAP_WIDTH="800"
		CAP_HEIGHT="600"
		CTRLS="${CTRLS},column_binning=1"
		;;
	"7")
		CAM_MODENAME="640x480 VGA with Skipping x4 and Binning"
		CAM_WIDTH="2560"
		CAM_HEIGHT="1920"
		CAM_OFFSET_TOP="12"
		CAM_OFFSET_LEFT="16"
		CAP_WIDTH="640"
		CAP_HEIGHT="480"
		CTRLS="${CTRLS},column_binning=1"
		;;
	"8")
		CAM_MODENAME="1920x1080 FullHD"
		CAM_WIDTH="1920"
		CAM_HEIGHT="1080"
		CAM_OFFSET_TOP="432"
		CAM_OFFSET_LEFT="336"
		CAP_WIDTH="1920"
		CAP_HEIGHT="1080"
		CTRLS="${CTRLS},column_binning=0"
		;;
	"9")
		CAM_MODENAME="1280x720 HD with Skipping x2 and Binning"
		CAM_WIDTH="2560"
		CAM_HEIGHT="1440"
		CAM_OFFSET_TOP="252"
		CAM_OFFSET_LEFT="16"
		CAP_WIDTH="1280"
		CAP_HEIGHT="720"
		CTRLS="${CTRLS},column_binning=1"
		;;
	"10")
		CAM_MODENAME="640x400 with Skipping x4 and Roi"
		CAM_WIDTH="2560"
		CAM_HEIGHT="1600"
		CAM_OFFSET_TOP="176"
		CAM_OFFSET_LEFT="16"
		CAP_WIDTH="640"
		CAP_HEIGHT="400"
		CTRLS="${CTRLS},column_binning=0"
		;;
	*)	echo "Invalid mode selected: $1" ; exit 1
	esac

	# Remove leading comma, if one exists.
	CAM_MODE_CTRLS=${CTRLS##,}
}
