CAM_PHYCAM_NAME="VM-024 / VM-124"

camera_select_format_interactive() {

	echo " Select Camera Sensor Format for VM-024 / VM-124"
	echo " ==============================================="

	if [ "$CAM_COLOR" = "COL" ] ; then
		echo " 1 = SGRBG8_1X8"
		echo " 2 = SGRBG10_1X10"

		read FMT_INDEX
		echo ""

		if [ -z "$FMT_INDEX" ] ; then
			CAM_FMT="SGRBG8_1X8"
		else
			case $FMT_INDEX in
				"1") CAM_FMT="SGRBG8_1X8" ;;
				"2") CAM_FMT="SGRBG10_1X10" ;;
				*) echo "Invalid format selection" ; exit 1 ;;
			esac
		fi
	else
		echo " 1 = Y8_1X8"
		echo " 2 = Y10_1X10"

		read FMT_INDEX
		echo ""

		if [ -z "$FMT_INDEX" ] ; then
			CAM_FMT="Y8_1X8"
		else
			case $FMT_INDEX in
				"1") CAM_FMT="Y8_1X8" ;;
				"2") CAM_FMT="Y10_1X10" ;;
				*) echo "Invalid format selection" ; exit 1 ;;
			esac
		fi
	fi

	format_configure $CAM_FMT
}

camera_select_format() {

	if [ -z "$1" ] ; then
		if [ "$CAM_COLOR" = "COL" ] ; then
			CAM_FMT="SGRBG8_1X8"
		else
			CAM_FMT="Y8_1X8"
		fi
	else
		CAM_FMT=$1
	fi

	format_configure $CAM_FMT

}

format_configure() {

	if [ -z "$1" ] ; then
		echo "No Format selected to configure"
		exit 1
	fi

	case $1 in
		"SGRBG8_1X8")
			CAP_FMT="GRBG"
			YAVTA_FMT="SGRBG8"
			GST_FMT="video/x-bayer,format=grbg"
			GST_CONV="bayer2rgbneon"
			;;
		"SGRBG10_1X10")
			CAP_FMT="BA10"
			YAVTA_FMT="SGRBG10"
			GST_FMT=""
			GST_CONV="bayer2rgbneon"
			;;
		"Y8_1X8")
			CAP_FMT="GREY"
			YAVTA_FMT="Y8"
			GST_FMT="video/x-raw,format=GRAY8"
			GST_CONV="queue ! videoconvert n-threads=4"
			;;
		"Y10_1X10")
			CAP_FMT="Y10"
			YAVTA_FMT="Y10"
			GST_FMT=""
			GST_CONV="queue ! videoconvert n-threads=4"
			;;
		*) echo "Unsupported Sensor Format: $1" ; exit 1
	esac

	CTRLS=""
	CTRLS="${CTRLS},auto_exposure=0"
	CTRLS="${CTRLS},gain_automatic=1"

	if [ "$CAM_COLOR" = "COL" ] ; then
		CTRLS="${CTRLS},red_balance=20"
		CTRLS="${CTRLS},blue_balance=200"
	fi

	# Remove leading comma, if one exists.
	CAM_FMT_CTRLS="${CTRLS##,}"

}

camera_select_mode_interactive() {

	echo ""
	echo "Select Camera Mode for VM-024 / VM-124"
	echo "======================================"
	echo "  1 = 3840 x 2160 UHD Full"
	echo "  2 = 3200 x 1800 QHD+, with ROI"
	echo "  3 = 2560 x 1440 QHD, with ROI"
	echo "  4 = 1920 x 1080 FullHD, with Skip2 and Row and Column Binning"
	echo "  5 = 1920 x 1080 FullHD, with Skip2 without Binning"
	echo "  6 = 1280 x 720  HD, with Skip2, ROI and Row and Column Binning"
	echo "  7 = 1280 x 720  HD, with Skip2, ROI without Binning"
	echo "  8 = 960  x 540  qHD, with Skip4 and Row and Column Binning"
	echo "  9 = 960  x 540  qHD, with Skip4 without Binning"

	read MODE
	echo ""

	if [ -z "$MODE" ] ; then
		MODE="1"
	fi

	mode_configure $MODE

}

camera_select_mode() {

	case "$1" in
	"Full" | "Default")
		MODE="1"
		;;
	"FullHD" )
		MODE="4"
		;;
	"HD" )
		MODE="6"
		;;
	"Dual" )
		MODE="9"
		;;
	* )
		MODE="$1"
		;;
	esac

	mode_configure $MODE
}

mode_configure() {

	if [ -z "$1" ] ; then
		echo "No Mode selected to configure"
		exit 1
	fi

	CAP_FRAME_CNT="1"
	GST_SRC_OPTS=""

	CTRLS=""
	case $1 in
	"1" | "")
		CAM_MODENAME="3840x2160 Full"
		CAM_WIDTH="3840"
		CAM_HEIGHT="2160"
		CAM_OFFSET_TOP="0"
		CAM_OFFSET_LEFT="0"
		CAP_WIDTH="3840"
		CAP_HEIGHT="2160"
		CTRLS="${CTRLS},auto_exposure_max=2160"
		CTRLS="${CTRLS},column_binning_enable=0"
		CTRLS="${CTRLS},row_binning_enable=0"
		;;
	"2")
		CAM_MODENAME="3200x1800 QHD+"
		CAM_WIDTH="3200"
		CAM_HEIGHT="1800"
		CAM_OFFSET_TOP="180"
		CAM_OFFSET_LEFT="320"
		CAP_WIDTH="3200"
		CAP_HEIGHT="1800"
		CTRLS="${CTRLS},auto_exposure_max=1800"
		CTRLS="${CTRLS},column_binning_enable=0"
		CTRLS="${CTRLS},row_binning_enable=0"
		;;
	"3")
		CAM_MODENAME="2560x1440 QHD"
		CAM_WIDTH="2560"
		CAM_HEIGHT="1440"
		CAM_OFFSET_TOP="360"
		CAM_OFFSET_LEFT="640"
		CAP_WIDTH="2560"
		CAP_HEIGHT="1440"
		CTRLS="${CTRLS},auto_exposure_max=1440"
		CTRLS="${CTRLS},column_binning_enable=0"
		CTRLS="${CTRLS},row_binning_enable=0"
		;;
	"4")
		CAM_MODENAME="1920x1080 FullHD with Skipping x2 and Binning"
		CAM_WIDTH="3840"
		CAM_HEIGHT="2160"
		CAM_OFFSET_TOP="0"
		CAM_OFFSET_LEFT="0"
		CAP_WIDTH="1920"
		CAP_HEIGHT="1080"
		CTRLS="${CTRLS},auto_exposure_max=1080"
		CTRLS="${CTRLS},column_binning_enable=1"
		CTRLS="${CTRLS},row_binning_enable=1"
		;;
	"5")
		CAM_MODENAME="1920x1080 FullHD with Skipping x2 without Binning"
		CAM_WIDTH="3840"
		CAM_HEIGHT="2160"
		CAM_OFFSET_TOP="0"
		CAM_OFFSET_LEFT="0"
		CAP_WIDTH="1920"
		CAP_HEIGHT="1080"
		CTRLS="${CTRLS},auto_exposure_max=1080"
		CTRLS="${CTRLS},column_binning_enable=0"
		CTRLS="${CTRLS},row_binning_enable=0"
		;;
	"6")
		CAM_MODENAME="1280x720 HD with ROI, Skipping x2 and Binning"
		CAM_WIDTH="2560"
		CAM_HEIGHT="1440"
		CAM_OFFSET_TOP="360"
		CAM_OFFSET_LEFT="640"
		CAP_WIDTH="1280"
		CAP_HEIGHT="720"
		CTRLS="${CTRLS},auto_exposure_max=720"
		CTRLS="${CTRLS},column_binning_enable=1"
		CTRLS="${CTRLS},row_binning_enable=1"
		;;
	"7")
		CAM_MODENAME="1280x720 HD with ROI, Skipping x2 without Binning"
		CAM_WIDTH="2560"
		CAM_HEIGHT="1440"
		CAM_OFFSET_TOP="360"
		CAM_OFFSET_LEFT="640"
		CAP_WIDTH="1280"
		CAP_HEIGHT="720"
		CTRLS="${CTRLS},auto_exposure_max=720"
		CTRLS="${CTRLS},column_binning_enable=0"
		CTRLS="${CTRLS},row_binning_enable=0"
		;;
	"8")
		CAM_MODENAME="960x540 qHD with Skipping x4 and Binning"
		CAM_WIDTH="3840"
		CAM_HEIGHT="2160"
		CAM_OFFSET_TOP="0"
		CAM_OFFSET_LEFT="0"
		CAP_WIDTH="960"
		CAP_HEIGHT="540"
		CTRLS="${CTRLS},auto_exposure_max=540"
		CTRLS="${CTRLS},column_binning_enable=1"
		CTRLS="${CTRLS},row_binning_enable=1"
		;;
	"9")
		CAM_MODENAME="960x540 qHD with Skipping x4 without Binning"
		CAM_WIDTH="3840"
		CAM_HEIGHT="2160"
		CAM_OFFSET_TOP="0"
		CAM_OFFSET_LEFT="0"
		CAP_WIDTH="960"
		CAP_HEIGHT="540"
		CTRLS="${CTRLS},auto_exposure_max=540"
		CTRLS="${CTRLS},column_binning_enable=0"
		CTRLS="${CTRLS},row_binning_enable=0"
		;;
	*)	echo "Invalid mode selected: $1" ; exit 1
	esac

	# Remove leading comma, if one exists.
	CAM_MODE_CTRLS=${CTRLS##,}
}
